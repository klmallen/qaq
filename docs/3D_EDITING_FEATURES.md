# QAQ游戏引擎3D编辑功能指南

## 🎯 **概述**

QAQ游戏引擎编辑器现在集成了两个强大的3D编辑功能：
1. **Transform Controls** - 高级3D物体变换控制器
2. **Viewport Gizmo** - 3D视口导航控制器

这些功能为3D场景编辑提供了专业级的用户体验，参考了Blender、Unity、UE等主流3D编辑器的设计。

## 🔧 **Transform Controls（变换控制器）**

### **功能特性**
- ✅ **三种变换模式**：移动(Translation)、旋转(Rotation)、缩放(Scale)
- ✅ **坐标系切换**：世界坐标系 / 本地坐标系
- ✅ **网格吸附**：精确对齐和定位
- ✅ **实时数值输入**：精确的数值控制
- ✅ **键盘快捷键**：快速切换工具模式
- ✅ **统一缩放**：保持物体比例的缩放选项

### **使用方法**

#### **基本操作**
1. **选择物体**：在场景树中选择节点或直接点击3D视口中的物体
2. **变换模式切换**：
   - **W键** 或点击移动图标：切换到移动模式
   - **E键** 或点击旋转图标：切换到旋转模式
   - **R键** 或点击缩放图标：切换到缩放模式

#### **高级功能**
- **坐标系切换**：点击地球/立方体图标在世界坐标系和本地坐标系间切换
- **网格吸附**：点击网格图标启用/禁用吸附功能
- **数值输入**：在右下角的Transform面板中直接输入精确数值

#### **键盘快捷键**
```
W - 移动工具
E - 旋转工具  
R - 缩放工具
X - 切换坐标系
G - 切换网格吸附
```

### **Transform面板功能**

#### **位置控制**
- **X/Y/Z轴**：独立控制每个轴向的位置
- **步进值**：0.1单位的精确调整
- **实时同步**：与3D视口中的控制器实时同步

#### **旋转控制**
- **欧拉角**：以度为单位的旋转角度
- **步进值**：1度的精确调整
- **角度范围**：支持360度全方位旋转

#### **缩放控制**
- **独立缩放**：X/Y/Z轴独立缩放
- **统一缩放**：保持比例的整体缩放
- **最小值限制**：防止负值或零值缩放

## 🧭 **Viewport Gizmo（视口导航器）**

### **功能特性**
- ✅ **View Cube**：直观的3D导航立方体
- ✅ **标准视图**：快速切换到前、后、左、右、顶、底视图
- ✅ **自由旋转**：拖拽View Cube进行自由视角调整
- ✅ **投影切换**：透视投影和正交投影切换
- ✅ **视图重置**：一键回到默认视角
- ✅ **聚焦功能**：自动聚焦到选中物体
- ✅ **轴向指示**：清晰的XYZ轴向显示

### **使用方法**

#### **View Cube操作**
1. **点击面**：点击立方体的任意面快速切换到对应视图
   - **前面**：前视图 (Numpad 1)
   - **后面**：后视图 (Ctrl+Numpad 1)
   - **右面**：右视图 (Numpad 3)
   - **左面**：左视图 (Ctrl+Numpad 3)
   - **顶面**：顶视图 (Numpad 7)
   - **底面**：底视图 (Ctrl+Numpad 7)

2. **点击边缘**：切换到对角视图（如前上视图）
3. **点击顶点**：切换到三维对角视图
4. **拖拽立方体**：自由旋转相机视角
5. **滚轮缩放**：在Gizmo上滚动鼠标滚轮进行缩放

#### **控制按钮**
- **🏠 重置视图**：回到默认透视视角
- **👁️ 投影切换**：在透视投影和正交投影间切换
- **🔍 聚焦选中**：自动聚焦到当前选中的物体

#### **键盘快捷键**
```
Numpad 1     - 前视图
Ctrl+Numpad 1 - 后视图
Numpad 3     - 右视图
Ctrl+Numpad 3 - 左视图
Numpad 7     - 顶视图
Ctrl+Numpad 7 - 底视图
Numpad 5     - 切换投影模式
Home         - 重置视图
F            - 聚焦选中物体
```

### **视图信息显示**
- **当前视图名称**：显示当前的视图类型（如"前视图"、"透视视图"）
- **投影类型**：显示当前使用的投影模式（透视/正交）

## 🎨 **UI设计特色**

### **QAQ主题集成**
- **主色调**：#00DC82 (QAQ绿色)
- **深色主题**：与编辑器整体风格一致
- **半透明背景**：使用backdrop-filter实现现代化效果
- **动画过渡**：平滑的视图切换动画

### **用户体验优化**
- **直观操作**：所见即所得的操作方式
- **视觉反馈**：悬停高亮和选中状态指示
- **响应式设计**：适配不同屏幕尺寸
- **无障碍支持**：完整的键盘快捷键支持

## 🔗 **与编辑器集成**

### **场景树同步**
- Transform Controls与场景树选择状态实时同步
- 选中场景树节点时自动激活对应的3D物体控制器
- 变换操作实时更新属性面板数值

### **属性面板联动**
- Transform面板的数值变化实时反映到属性面板
- 支持撤销/重做操作（计划中）
- 变换历史记录（计划中）

### **性能优化**
- 使用three-freeform-controls库提供高性能的变换控制
- 平滑的60fps动画和交互
- 智能的渲染优化

## 🚀 **技术实现**

### **依赖库**
- **three-freeform-controls**：高级Transform Controls实现
- **Three.js**：3D渲染引擎
- **Vue 3**：响应式UI框架

### **组件架构**
```
QaqViewport3D.vue (主视口)
├── QaqViewportGizmo.vue (视口导航器)
└── QaqTransformControls.vue (变换控制器)
```

### **事件系统**
- `transform-change`：变换操作事件
- `view-change`：视图切换事件
- `projection-change`：投影模式切换事件
- `mode-change`：工具模式切换事件

## 📋 **使用示例**

### **基础3D编辑工作流**
1. **创建场景**：在场景树中添加MeshInstance3D节点
2. **选择物体**：点击场景树节点或3D视口中的物体
3. **调整位置**：使用W键切换到移动模式，拖拽控制器或输入精确数值
4. **调整角度**：使用E键切换到旋转模式，旋转物体到合适角度
5. **调整大小**：使用R键切换到缩放模式，调整物体尺寸
6. **切换视角**：使用Viewport Gizmo快速切换到不同视角检查效果

### **高级编辑技巧**
- **精确定位**：启用网格吸附功能进行精确对齐
- **多视角检查**：使用标准视图检查物体在不同角度的效果
- **聚焦编辑**：使用F键快速聚焦到选中物体进行细节编辑

## 🎉 **总结**

QAQ游戏引擎的3D编辑功能现在已经达到了专业级水准：

✅ **专业级Transform Controls** - 精确的3D物体变换控制  
✅ **直观的Viewport Gizmo** - 流畅的3D导航体验  
✅ **完整的键盘快捷键** - 高效的编辑工作流  
✅ **实时同步更新** - 场景树、属性面板、3D视口三方联动  
✅ **现代化UI设计** - 与QAQ编辑器风格完美融合  

这些功能为QAQ游戏引擎提供了强大的3D场景编辑能力，让开发者能够高效地创建和编辑3D游戏内容！🚀
